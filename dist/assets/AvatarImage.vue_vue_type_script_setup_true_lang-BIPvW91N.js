import{c as A}from"./index-D4NkeJUS.js";import{d as f,b as c,c as p,o as v,w as m,g as _,u as o,e as L,X as w,K as q,a0 as R,N as E,G as I,af as P,ag as B,n as $,m as x}from"./index-BYKe6ZG4.js";import{u as C,i as k}from"./useForwardExpose-DVWe5bFq.js";import{P as S}from"./index-BTa86PfG.js";import{c as z}from"./createContext-2ZjIYkVj.js";const[O,M]=z("AvatarRoot");var b=f({__name:"AvatarRoot",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(t){return C(),M({imageLoadingStatus:c("idle")}),(e,r)=>(v(),p(o(S),{"as-child":e.asChild,as:e.as},{default:m(()=>[_(e.$slots,"default")]),_:3},8,["as-child","as"]))}}),j=b;function y(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function D(t,{referrerPolicy:e,crossOrigin:r}={}){const s=c(!1),l=c(null),i=L(()=>s.value?(!l.value&&k&&(l.value=new window.Image),l.value):null),u=c(y(i.value,t.value)),d=n=>()=>{s.value&&(u.value=n)};return w(()=>{s.value=!0,q(n=>{const a=i.value;if(!a)return;u.value=y(a,t.value);const g=d("loaded"),h=d("error");a.addEventListener("load",g),a.addEventListener("error",h),e?.value&&(a.referrerPolicy=e.value),typeof r?.value=="string"&&(a.crossOrigin=r.value),n(()=>{a.removeEventListener("load",g),a.removeEventListener("error",h)})})}),R(()=>{s.value=!1}),u}var F=f({__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},crossOrigin:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"img"}},emits:["loadingStatusChange"],setup(t,{emit:e}){const r=t,s=e,{src:l,referrerPolicy:i,crossOrigin:u}=E(r);C();const d=O(),n=D(l,{referrerPolicy:i,crossOrigin:u});return I(n,a=>{s("loadingStatusChange",a),a!=="idle"&&(d.imageLoadingStatus.value=a)},{immediate:!0}),(a,g)=>P((v(),p(o(S),{role:"img","as-child":a.asChild,as:a.as,src:o(l),"referrer-policy":o(i)},{default:m(()=>[_(a.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[B,o(n)==="loaded"]])}}),G=F;const H=f({__name:"Avatar",props:{class:{}},setup(t){const e=t;return(r,s)=>(v(),p(o(j),{"data-slot":"avatar",class:$(o(A)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e.class))},{default:m(()=>[_(r.$slots,"default")]),_:3},8,["class"]))}}),J=f({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(t){const e=t;return(r,s)=>(v(),p(o(G),x({"data-slot":"avatar-image"},e,{class:"aspect-square size-full"}),{default:m(()=>[_(r.$slots,"default")]),_:3},16))}});export{H as _,J as a,O as i};
